/* fork.js 0.0.1 
 Copyright (c) 2013 Allen Heavey
*/!function(a){"use strict";function b(){}function c(a){var b={};for(var c in a)b[c]=a[c];return b}function d(b){var c=b;if(c){for(var d in a)c[d]?delete c[d]:delete a[d];for(var e in c)a[e]=c[e]}}function e(a){var b="http://"===a.substring(0,6),c="file://"===a.substring(0,6);return b||c}function f(a){return"/"===a.charAt(0)}function g(a){return a.match(A)[0]}function h(a){var b=a.slice(-3);return".js"!==b&&(a+=".js"),a}function i(a,b,c){var d;if(c)if("r"===c)for(d=g(b)+a;d.match(B);)d=d.replace(B,"/");else"a"===c&&(d=b?g(b)+a:v+a);else d=b+a;return d}function j(a,b){if(f(a))return a;var c,d=a.charAt(0),e=d+a.charAt(1);return"."===d?"./"===e?c=b+a.substring(2):".."===e&&(c=i(a,b,"r")):"/"===d&&(c=i(a,b,"a")),c}function k(a,b){if(!a)throw new Error("You should require something.");return e(a)?a:(b||(b=C),a=h(a),j(a,b))}function l(d,e){var f=document.createElement("script");e.status<x.LOADING&&(e.status=x.LOADING),a.module=e,a.exports=e.exports,a.require=e.require;var g=c(a);for(a.global=g,e.status<x.LOADED&&m(f,g,e),f.async=!0,f.src=d,z=f,D.appendChild(f),e.status=x.LOADED,z=null;e.status<x.EXECUTING;)setTimeout(b,10);return e}function m(a,b,c,e){a.onload=a.onerror=function(){E.test(a.readyState)&&(a.onload=a.onerror=null,e.status=x.EXECUTING,D.removeChild(a),a=null,e.save(),d(c))}}function n(a){this.uri=a,this.exports=null,this.status=0}var o={version:"0.0.1"},p=location,q={},r=document.getElementById("forkjs"),s=r.src||r.getAttribute("src",4),t=g(s),u=/^.*\w+\.\w+\//,v=t.match(u)[0],w={};w.isBoolean=function(a){return"boolean"==typeof a},w.isNull=function(a){return null===a},w.isNumber=function(a){return"number"==typeof a},w.isString=function(a){return"string"==typeof a},w.isUndefined=function(a){return void 0===a},w.isObject=function(a){return"object"==typeof a&&null!==a},w.isFunction=function(a){return"function"==typeof a};var x=n.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6},y=q.events={};o.on=function(a,b){for(var c=y[a]||(y[a]=[]),d=!1,e=0,f=c.length;f>e;e++)c[e]===b&&(d=!0);return d||c.push(b),o},o.addListener=o.on,o.off=function(a,b){if(!a)throw new Error("You should have a name when you remove a listener.");var c=y[a];if(c)if(b){for(var d=c.length;d>=0;d--)if(c[d]===b){c.splice(d,1);break}}else delete y[a];return module.js},o.removeListener=o.off,o.removeAllListener=function(a){a?delete y[a]:(delete q.events,y=q.events={})},o.emit=function(a){var b,c=y[a],d=arguments.slice(1);if(c)for(c=c.slice();b=c.shift();)b(d)};var z,A=/[^?#]*\//,B=/\/[^/]+\/\.\.\//,C=q.cwd=g(p.href),D=document.getElementsByTagName("head")[0]||document.documentElement,E=/^(?:loaded|complete|undefined)$/,F=o.cache={},G={},H={};n.resolve=function(a,b){var c={id:a,refUri:b};return emit("resolve",c),c.uri||k(a,b)},n.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=0,e=b.length;e>d;d++)c[d]=n.resolve(b[d],a.uri);return c},n.prototype.load=function(){var a=this;a.status>=x.LOADING||(a.status=x.LOADING,a.resolve())},n.prototype.onload=function(){var a=this;a.status=x.LOADED,a.callback&&a.callback();var b,c,d=a.waitings;for(b in d)d.hasOwnProperty(b)&&(c=F[b],c.remain-=d[b],0===c.remain&&c.onload());delete a.waitings,delete a.remain},n.prototype.fetch=function(){function a(){l(requestUri,b)}var b=this,c=b.uri;b.status=b.status<x.FETCHING?b.status:x.FETCHING,G[c]=!0,H[c]=[b],b.status<x.LOADING&&(b.status=x.LOADING,a())},n.get=function(a){var b=F[a]||(F[a]=new n(a));return b.status>=x.EXECUTING?b:(b.status=x.FETCHING,b.fetch(),b)},n.prototype.exec=function(){for(var a,c=this;c.status<x.EXECUTING;)setTimeout(b,0);return c.status>=x.EXECUTING&&(a=c.exports),a},n.prototype.require=function(a){var b=this,c=b.uri||o.cwd;return n.get(n.resolve(a,c)).exec()},a.forkjs=o,a.require=require}(window);