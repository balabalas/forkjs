/* fork.js 0.0.1 
 Copyright (c) 2013 Allen Heavey
*/!function(a){"use strict";function b(a){return function(b){return{}.toString.call(b)==="[object "+a+"]"}}function c(){}function d(a){var b={};for(var c in a)b[c]=a[c];return b}function e(b){var c=b;if(c){for(var d in a)c[d]?delete c[d]:delete a[d];for(var e in c)a[e]=c[e]}}function f(a){return a.match(o)[0]}function g(b,e){var f=document.createElement("script");e.status<m.LOADING&&(e.status=m.LOADING),a.module=e,a.exports=e.exports,a.require=e.require;var g=d(a);for(a.global=g,e.status<m.LOADED&&h(f,g,e),f.async=!0,f.src=b,p=f,q.appendChild(f),e.status=m.LOADED,p=null;e.status<m.EXECUTING;)setTimeout(c,10);return e}function h(a,b,c,d){a.onload=a.onerror=function(){r.test(a.readyState)&&(a.onload=a.onerror=null,d.status=m.EXECUTING,q.removeChild(a),a=null,d.save(),e(c))}}function i(a){this.uri=a,this.exports=null,this.status=0}var j={version:"0.0.1"};b("Object"),Array.isArray||b("Array"),b("String"),b("Function");var k=location,l={},m=i.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6},n=l.events={};j.on=function(a,b){for(var c=n[a]||(n[a]=[]),d=!1,e=0,f=c.length;f>e;e++)c[e]===b&&(d=!0);return d||c.push(b),j},j.addListener=j.on,j.off=function(a,b){if(!a)throw new Error("You should have a name when you remove a listener.");var c=n[a];if(c)if(b){for(var d=c.length;d>=0;d--)if(c[d]===b){c.splice(d,1);break}}else delete n[a];return module.js},j.removeListener=j.off,j.removeAllListener=function(a){a?delete n[a]:(delete l.events,n=l.events={})},j.emit=function(a){var b,c=n[a],d=arguments.slice(1);if(c)for(c=c.slice();b=c.shift();)b(d)};var o=/[^?#]*\//;l.cwd=f(k.href);var p,q=document.getElementsByTagName("head")[0]||document.documentElement,r=/^(?:loaded|complete|undefined)$/,s=j.cache={},t={},u={};i.resolve=function(a,b){var c={id:a,refUri:b};return emit("resolve",c),c.uri||id2uri(a,b)},i.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=0,e=b.length;e>d;d++)c[d]=i.resolve(b[d],a.uri);return c},i.prototype.load=function(){var a=this;a.status>=m.LOADING||(a.status=m.LOADING,a.resolve())},i.prototype.onload=function(){var a=this;a.status=m.LOADED,a.callback&&a.callback();var b,c,d=a.waitings;for(b in d)d.hasOwnProperty(b)&&(c=s[b],c.remain-=d[b],0===c.remain&&c.onload());delete a.waitings,delete a.remain},i.prototype.fetch=function(){function a(){g(requestUri,b)}var b=this,c=b.uri;b.status=b.status<m.FETCHING?b.status:m.FETCHING,t[c]=!0,u[c]=[b],b.status<m.LOADING&&(b.status=m.LOADING,a())},i.get=function(a){var b=s[a]||(s[a]=new i(a));return b.status>=m.EXECUTING?b:(b.status=m.FETCHING,b.fetch(),b)},i.prototype.exec=function(){for(var a,b=this;b.status<m.EXECUTING;)setTimeout(c,0);return b.status>=m.EXECUTING&&(a=b.exports),a},i.prototype.require=function(a){var b=this,c=b.uri||j.cwd;return i.get(i.resolve(a,c)).exec()},a.forkjs=j,a.require=require}(window);