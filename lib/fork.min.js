/* fork.js 0.0.1 
 Copyright (c) 2013 Allen Heavey
*/!function(a){"use strict";function b(){}function c(a){var b={};for(var c in a)b[c]=a[c];return b}function d(b){var c=b;if(c){for(var d in a)c[d]?delete c[d]:delete a[d];for(var e in c)a[e]=c[e]}}function e(a){var b="http://"===a.substring(0,6),c="file://"===a.substring(0,6);return b||c}function f(a){return"/"===a.charAt(0)}function g(a){var b=/[^?#]*\//;return a.match(b)[0]}function h(a){var b=a.slice(-3);return".js"!==b&&(a+=".js"),a}function i(a,b,c){var d;if(c)if("r"===c)for(d=g(b)+a;d.match(B);)d=d.replace(B,"/");else"a"===c&&(d=b?g(b)+a:w+a);else d=b+a;return d}function j(a,b){if(f(a))return a;var c,d=a.charAt(0),e=d+a.charAt(1);return"."===d?"./"===e?c=b+a.substring(2):".."===e&&(c=i(a,b,"r")):"/"===d&&(c=i(a,b,"a")),c}function k(a,b){if(!a)throw new Error("You should require something.");return e(a)?a:(b||(b=u),a=h(a),j(a,b))}function l(d,e){var f=document.createElement("script");e.status<y.LOADING&&(e.status=y.LOADING),a.module=e,a.exports=e.exports,a.require=e.require;var g=c(a);for(a.global=g,e.status<y.LOADED&&m(f,g,e),f.async=!0,f.src=d,A=f,C.appendChild(f),e.status=y.LOADED,A=null;e.status<y.EXECUTING;)setTimeout(b,10);return e}function m(a,b,c,e){a.onload=a.onerror=function(){D.test(a.readyState)&&(a.onload=a.onerror=null,e.status=y.EXECUTING,C.removeChild(a),a=null,e.save(),d(c))}}function n(a){this.uri=a,this.exports=null,this.status=0}var o={version:"0.0.1"},p=location,q={};q.pwd=g(p.href);var r=document.getElementById("forkjs");r.getAttribute("data-main");var s=r.src||r.getAttribute("src",4),t=g(s),u=q.cwd=t,v=/^.*\w+\.\w+\//,w=t.match(v)?t.match(v)[0]:"",x={};x.isBoolean=function(a){return"boolean"==typeof a},x.isNull=function(a){return null===a},x.isNumber=function(a){return"number"==typeof a},x.isString=function(a){return"string"==typeof a},x.isUndefined=function(a){return void 0===a},x.isObject=function(a){return"object"==typeof a&&null!==a},x.isFunction=function(a){return"function"==typeof a};var y=n.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6},z=q.events={};o.on=function(a,b){for(var c=z[a]||(z[a]=[]),d=!1,e=0,f=c.length;f>e;e++)c[e]===b&&(d=!0);return d||c.push(b),o},o.addListener=o.on,o.off=function(a,b){if(!a)throw new Error("You should have a name when you remove a listener.");var c=z[a];if(c)if(b){for(var d=c.length;d>=0;d--)if(c[d]===b){c.splice(d,1);break}}else delete z[a];return module.js},o.removeListener=o.off,o.removeAllListener=function(a){a?delete z[a]:(delete q.events,z=q.events={})},o.emit=function(a){var b,c=z[a],d=arguments.slice(1);if(c)for(c=c.slice();b=c.shift();)b(d)};var A,B=/\/[^/]+\/\.\.\//,C=document.getElementsByTagName("head")[0]||document.documentElement,D=/^(?:loaded|complete|undefined)$/,E=o.cache={},F={},G={};n.resolve=function(a,b){var c={id:a,refUri:b};return emit("resolve",c),c.uri||k(a,b)},n.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=0,e=b.length;e>d;d++)c[d]=n.resolve(b[d],a.uri);return c},n.prototype.load=function(){var a=this;a.status>=y.LOADING||(a.status=y.LOADING,a.resolve())},n.prototype.onload=function(){var a=this;a.status=y.LOADED,a.callback&&a.callback();var b,c,d=a.waitings;for(b in d)d.hasOwnProperty(b)&&(c=E[b],c.remain-=d[b],0===c.remain&&c.onload());delete a.waitings,delete a.remain},n.prototype.fetch=function(){function a(){l(requestUri,b)}var b=this,c=b.uri;b.status=b.status<y.FETCHING?b.status:y.FETCHING,F[c]=!0,G[c]=[b],b.status<y.LOADING&&(b.status=y.LOADING,a())},n.get=function(a){var b=E[a]||(E[a]=new n(a));return b.status>=y.EXECUTING?b:(b.status=y.FETCHING,b.fetch(),b)},n.prototype.exec=function(){for(var a,c=this;c.status<y.EXECUTING;)setTimeout(b,0);return c.status>=y.EXECUTING&&(a=c.exports),a},n.prototype.require=function(a){var b=this,c=b.uri||o.cwd;return n.get(n.resolve(a,c)).exec()},a.forkjs=o}(window);