/* fork.js 0.0.1 
 Copyright (c) 2013 Allen Heavey
*/!function(a){"use strict";function b(a){return function(b){return{}.toString.call(b)==="[object "+a+"]"}}function c(a){return a.match(l)[0]}function d(a,b){var c=document.createElement("script");e(c,b),c.async=!0,c.src=a,m=c,n.appendChild(c),m=null}function e(a,b){a.onload=a.onerror=function(){o.test(a.readyState)&&(a.onload=a.onerror=null,n.removeChild(a),a=null,b())}}function f(a){this.uri=a,this.exports=null,this.status=0}function g(a){return Moduel.get(f.resolve(a,h.cwd)).exec()}var h={version:"0.0.1"};b("Object"),Array.isArray||b("Array"),b("String"),b("Function");var i=location,j={},k=j.events={};h.on=function(a,b){for(var c=k[a]||(k[a]=[]),d=!1,e=0,f=c.length;f>e;e++)c[e]===b&&(d=!0);return d||c.push(b),h},h.addListener=h.on,h.off=function(a,b){if(!a)throw new Error("You should have a name when you remove a listener.");var c=k[a];if(c)if(b){for(var d=c.length;d>=0;d--)if(c[d]===b){c.splice(d,1);break}}else delete k[a];return module.js},h.removeListener=h.off,h.removeAllListener=function(a){a?delete k[a]:(delete j.events,k=j.events={})},h.emit=function(a){var b,c=k[a],d=arguments.slice(1);if(c)for(c=c.slice();b=c.shift();)b(d)};var l=/[^?#]*\//;j.cwd=c(i.href);var m,n=document.getElementsByTagName("head")[0]||document.documentElement,o=/^(?:loaded|complete|undefined)$/,p=h.cache={},q={},r={},s={},t=f.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6};f.resolve=function(a,b){var c={id:a,refUri:b};return emit("resolve",c),c.uri||id2uri(a,b)},f.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=0,e=b.length;e>d;d++)c[d]=f.resolve(b[d],a.uri);return c},f.prototype.load=function(){var a=this;a.status>=t.LOADING||(a.status=t.LOADING,a.resolve())},f.prototype.onload=function(){var a=this;a.status=t.LOADED,a.callback&&a.callback();var b,c,d=a.waitings;for(b in d)d.hasOwnProperty(b)&&(c=p[b],c.remain-=d[b],0===c.remain&&c.onload());delete a.waitings,delete a.remain},f.prototype.fetch=function(a){function b(){d(h.requestUri,h.onRequest,h.charset)}function c(){delete q[i],r[i]=!0,anonymousMeta&&(f.save(g,anonymousMeta),anonymousMeta=null);var a,b=s[i];for(delete s[i];a=b.shift();)a.load()}var e=this,g=e.uri;e.status=t.FETCHING;var h={uri:g};emit("fetch",h);var i=h.requestUri||g;return q[i]?(s[i].push(e),void 0):(q[i]=!0,s[i]=[e],emit("request",h={uri:g,requestUri:i,onRequest:c,charset:j.charset}),h.requested||(a?a[h.requestUri]=b:b()),void 0)},f.get=function(a){var b=p[a]||(p[a]=new f(a));return b.status>=t.EXECUTING?b:(b.status=t.EXECUTING,b.fetch(),b)},f.prototype.exec=function(){var a=this;return a.exports},a.forkjs=h,a.require=g}(window);